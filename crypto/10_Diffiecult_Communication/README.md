# Diffiecult Communication

**Description:** Bob has sent you a message using a combination of modern cryptographic algorithms that is encrypted inside the file `encrypted_msg.bin`.

Firstly, the Diffie-Hellman (DH) key exchange algorithm was used to derive a shared key between Bob and yourself. In the file `dh_key_exchange.py`, the public base and modulus, Bob's public key and your private key for the DH key exchange are all provided.

The shared key is then hashed using SHA256 that is then used to encrypt Bob's original message using AES-256-CBC with an initial vector of 16 null bytes (`b"\x00"*16`).

**Flag:** CTF{g1mMe_4_j1fFie_t0_d3cRyPt_tH15_d1fFi3!}

**Provided Files:** [students_diffiecult_communications.zip](provided_files/students_diffiecult_communications.zip)

## Solution

* [Solution](challenge_files/solution.py)

## Notes

* Bob's Private key =
```
26564897920737246875396217274347755591489154545753528654885205408664939848995016811615957263309811965325748106445750947744080692059172737865543329337507720397642052568284978274935501031570646993870510027348868916603900402727277082320481242266958871062203622020394953560164893819101187058737601021841244844456900126228727892247109446968101095549355282114548343734710651491888380365549638652174031550813739024407241755980428803231096152634686800932554314446782600073243697842116143773693845814893745526656198173096004725536962035148914090470449119930610548567772347953223028259500423836396702969495286430736292196571169
```

* Shared key as an integer =
```
19772064943896711964397951616368746412512006221390899703229825303572533319352137267901297483796546270070392626021902239836349657673927944666034420802566846058422381368951512425138513592415881406532492329810528984307440321881078513459610712634171580924689419253350698507008935284457797850429707233161707021863001004974666582522207655229960938582051145307448895094398622852215986145480201823248120034241950543456710572279497266485460628164120436739748723520670721151415068524863023935067395846565097529723318228611754980636726855521173879329859442332842058613146539023061431542253038379057017811897129000325060653294520
```
