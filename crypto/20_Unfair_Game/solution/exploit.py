from pwn import *
import os

RHOST = "127.0.0.1"
RPORT = 1337

def crack_seed(target_num):
    # Make sure to complile the seed_cracker.c to crack the seed
    return os.popen("./cracker {num}".format(num=target_num)).read().split("\n")[:-1]

def main():
    r_conn = remote(RHOST, RPORT)
    r_conn.recvuntil("I am thinking of a random integer, which number do you think it is?\r\n")

    # Hope that you guess incorrectly to get the first random number from the seed that is set
    r_conn.send("-1\r\n")
    failed_str = r_conn.recvline().decode()
    target_num = failed_str.split(' ')[-1][:-3]

    next_nums = crack_seed(target_num)

    for num in next_nums:
        r_conn.send(num + "\r\n")

    r_conn.interactive()


if __name__ == "__main__":
    main()
